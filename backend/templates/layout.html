{{define "layout"}}
<!DOCTYPE html>
<html lang="es">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>{{if .Title}}{{.Title}} · {{end}}HeartGuard Admin</title>
		<link rel="stylesheet" href="/ui-assets/css/app.css" />
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
		<script defer src="/ui-assets/js/app.js"></script>
		{{if .SessionExpiresAt}}
		<script>
			window.sessionExpiresAt = {{.SessionExpiresAt.Unix}} * 1000;
		</script>
		{{end}}
	</head>
	<body class="hg-body">
		<header class="hg-header">
			<div class="hg-brand">
				<a href="/superadmin/dashboard">{{if .Settings}}{{.Settings.BrandName}}{{else}}HeartGuard{{end}}</a>
			</div>
			<nav class="hg-user-nav">
				{{if .CurrentUser}}
				<span class="hg-user-name">{{.CurrentUser.Name}}</span>
				<form method="post" action="/logout" class="hg-inline-form">
					<input type="hidden" name="_csrf" value="{{.CSRFToken}}" />
					<button type="submit" class="hg-link">Cerrar sesión</button>
				</form>
				{{end}}
			</nav>
		</header>
		<div class="hg-container">
			<aside class="hg-sidebar">
				<ul>
					<li><a href="/superadmin/dashboard">Panel</a></li>
					<li><a href="/superadmin/services">Servicios</a></li>
					<li><a href="/superadmin/organizations">Organizaciones</a></li>
					<li><a href="/superadmin/invitations">Invitaciones</a></li>
					<li><a href="/superadmin/users">Usuarios</a></li>
					<li><a href="/superadmin/roles">Roles</a></li>
					<li><a href="/superadmin/caregivers">Cuidadores</a></li>
					<li><a href="/superadmin/care-teams">Equipos de cuidado</a></li>
					<li><a href="/superadmin/patients">Pacientes</a></li>
					<li><a href="/superadmin/ground-truth">Ground Truth</a></li>
					<li><a href="/superadmin/devices">Dispositivos</a></li>
					<li><a href="/superadmin/push-devices">Dispositivos push</a></li>
					<li><a href="/superadmin/signal-streams">Streams de señal</a></li>
					<li><a href="/superadmin/models">Modelos ML</a></li>
					<li><a href="/superadmin/event-types">Eventos</a></li>
					<li><a href="/superadmin/inferences">Inferencias</a></li>
					<li><a href="/superadmin/alerts">Alertas</a></li>
					<li><a href="/superadmin/catalogs">Catálogos</a></li>
					<li><a href="/superadmin/audit">Auditoría</a></li>
					<li><a href="/superadmin/settings/system">Configuración</a></li>
				</ul>
			</aside>
			<main class="hg-main">
				{{if .Breadcrumbs}}
				<nav class="hg-breadcrumbs">
					<ul>
						{{range $i, $crumb := .Breadcrumbs}}
						<li>{{if $crumb.URL}}<a href="{{$crumb.URL}}">{{$crumb.Label}}</a>{{else}}{{$crumb.Label}}{{end}}</li>
						{{end}}
					</ul>
				</nav>
				{{end}} {{if .Flashes}}
				<div class="hg-flashes">
					{{range .Flashes}}
					<div class="hg-flash hg-flash-{{.Type}}">{{.Message}}</div>
					{{end}}
				</div>
				{{end}} {{if .ContentHTML}} {{.ContentHTML}} {{end}}
			</main>
		</div>

		<!-- Session expiration warning modal -->
		<div id="session-warning-modal" class="hg-modal" style="display: none">
			<div class="hg-modal-content">
				<div class="hg-modal-header">
					<h2>⚠️ Tu sesión está por expirar</h2>
				</div>
				<div class="hg-modal-body">
					<p>Tu sesión se cerrará automáticamente en <strong id="session-countdown">5:00</strong>.</p>
					<p>¿Deseas continuar con tu sesión?</p>
				</div>
				<div class="hg-modal-footer">
					<button id="extend-session-btn" class="hg-btn hg-btn-primary">Sí, extender sesión</button>
					<button id="logout-now-btn" class="hg-btn hg-btn-secondary">Cerrar sesión ahora</button>
				</div>
			</div>
		</div>
		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
	</body>
</html>
{{end}}
