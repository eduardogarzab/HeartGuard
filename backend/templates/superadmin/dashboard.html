{{define "superadmin/dashboard.html"}} {{template "layout" .}} {{end}} {{define "superadmin/dashboard.html:content"}}
<section class="hg-section">
	<div class="hg-dashboard-heading">
		<div>
			<h1>Panel</h1>
			<p class="hg-section-subtitle">Resumen ejecutivo del entorno superadmin</p>
		</div>
		<div class="hg-dashboard-actions">
			<a class="hg-link-button" href="/superadmin/dashboard/export?format=pdf">Exportar PDF</a>
			<a class="hg-link-button hg-button-muted" href="/superadmin/dashboard/export?format=csv">Exportar CSV</a>
		</div>
	</div>
	{{if .Data.Metrics}}
	<div class="hg-dashboard-kpis">
		{{range .Data.Metrics}}
		<article class="hg-kpi-card">
			<span class="hg-kpi-label">{{.Label}}</span>
			<span class="hg-kpi-value">{{.Value}}</span>
			<span class="hg-kpi-caption">{{.Caption}}</span>
		</article>
		{{end}}
	</div>
	{{end}}
</section>

<section class="hg-section">
	<header class="hg-dashboard-section-header">
		<div>
			<h2>Operación y usuarios</h2>
			<p>Estado de cuentas, invitaciones y actividad auditada más reciente.</p>
		</div>
	</header>
	<div class="hg-dashboard-grid">
		<article class="hg-chart-card">
			<header>
				<h3>Estado de usuarios</h3>
				<span class="hg-chart-meta">Total: {{.Data.StatusTotal}}</span>
			</header>
			{{if .Data.StatusChart}}
			<div class="hg-chart-visual">
				<canvas id="hgChartStatus" class="hg-chart-canvas" data-hg-type="doughnut" data-hg-series-label="Usuarios" data-hg-chart="{{toJSON .Data.StatusChart}}"></canvas>
			</div>
			<div class="hg-chart-bars hg-chart-fallback">
				{{range $idx, $entry := .Data.StatusChart}}
				<div class="hg-chart-bar" data-hg-entry-index="{{$idx}}">
					<span class="hg-chart-bar-label">{{$entry.Label}}</span>
					<div class="hg-chart-bar-track">
						{{if $entry.State}}
						<div class="hg-chart-bar-fill is-{{$entry.State}}" style="--hg-bar-width: {{$entry.Width}}"></div>
						{{else}}
						<div class="hg-chart-bar-fill" style="--hg-bar-width: {{$entry.Width}}"></div>
						{{end}}
					</div>
					<span class="hg-chart-bar-count">{{$entry.Count}}</span>
				</div>
				{{end}}
			</div>
			{{else}}
			<p class="hg-chart-empty">Sin datos suficientes para mostrar el estado.</p>
			{{end}}
		</article>
		<article class="hg-chart-card">
			<header>
				<h3>Invitaciones</h3>
				<span class="hg-chart-meta">Total: {{.Data.InvitationTotal}}</span>
			</header>
			{{if .Data.InvitationChart}}
			<div class="hg-chart-visual">
				<canvas id="hgChartInvitations" class="hg-chart-canvas" data-hg-type="doughnut" data-hg-series-label="Invitaciones" data-hg-chart="{{toJSON .Data.InvitationChart}}"></canvas>
			</div>
			<div class="hg-chart-bars hg-chart-fallback">
				{{range $idx, $entry := .Data.InvitationChart}}
				<div class="hg-chart-bar" data-hg-entry-index="{{$idx}}">
					<span class="hg-chart-bar-label">{{$entry.Label}}</span>
					<div class="hg-chart-bar-track">
						{{if $entry.State}}
						<div class="hg-chart-bar-fill is-{{$entry.State}}" style="--hg-bar-width: {{$entry.Width}}"></div>
						{{else}}
						<div class="hg-chart-bar-fill" style="--hg-bar-width: {{$entry.Width}}"></div>
						{{end}}
					</div>
					<span class="hg-chart-bar-count">{{$entry.Count}}</span>
				</div>
				{{end}}
			</div>
			{{else}}
			<p class="hg-chart-empty">Sin invitaciones registradas.</p>
			{{end}}
		</article>
		<article class="hg-chart-card">
			<header>
				<h3>Operaciones destacadas</h3>
				<span class="hg-chart-meta">Últimos eventos agregados</span>
			</header>
			{{if .Data.RecentOperations}}
			<div class="hg-chart-visual">
				<canvas
					id="hgChartOperations"
					class="hg-chart-canvas"
					data-hg-type="bar"
					data-hg-index-axis="y"
					data-hg-series-label="Eventos"
					data-hg-chart="{{toJSON .Data.RecentOperations}}"></canvas>
			</div>
			{{else}}
			<p class="hg-chart-empty">Sin operaciones recientes.</p>
			{{end}}
		</article>
		<article class="hg-chart-card is-wide is-full">
			<header>
				<h3>Actividad reciente</h3>
				<span class="hg-chart-meta">Eventos auditados en la última jornada</span>
			</header>
			{{if .Data.ActivitySeries}}
			<div class="hg-chart-visual hg-chart-visual--line">
				<canvas id="hgChartActivity" class="hg-chart-canvas" data-hg-type="line" data-hg-series-label="Eventos" data-hg-chart="{{toJSON .Data.ActivitySeries}}"></canvas>
			</div>
			{{end}} {{if .Data.RecentActivity}}
			<ul class="hg-activity-feed hg-activity-feed--compact">
				{{range .Data.RecentActivity}}
				<li>
					<strong>{{.Label}}</strong>
					<span>{{formatTime .Timestamp}}{{if .Actor}} &mdash; {{.Actor}}{{end}}{{if .Entity}} &middot; {{.Entity}}{{end}}</span>
				</li>
				{{end}}
			</ul>
			{{else}}
			<p class="hg-chart-empty">Sin actividad reciente.</p>
			{{end}}
		</article>
	</div>
</section>

{{end}}
