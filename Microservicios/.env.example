# =============================
# HeartGuard Microservices ENV
# =============================
# Copiar este archivo a .env y ajustar valores reales antes del despliegue.

# ---- Configuraci√≥n global ----
GATEWAY_URL=http://34.70.7.33:5000
AUTH_URL=http://34.70.7.33:5001
ORGANIZATION_URL=http://34.70.7.33:5002
USER_URL=http://34.70.7.33:5003
PATIENT_URL=http://34.70.7.33:5004
DEVICE_URL=http://34.70.7.33:5005
INFLUX_SERVICE_URL=http://34.70.7.33:5006
INFERENCE_URL=http://34.70.7.33:5007
ALERT_URL=http://34.70.7.33:5008
NOTIFICATION_URL=http://34.70.7.33:5009
MEDIA_URL=http://34.70.7.33:5010
AUDIT_URL=http://34.70.7.33:5011
RABBITMQ_URL=amqp://heartguard:change_me@rabbitmq:5672/heartguard
REDIS_URL=redis://redis:6379/0
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_SUPERUSER=postgres
POSTGRES_SUPERPASS=postgres
INFLUX_URL=http://influxdb:8086
INFLUX_TOKEN=replace-with-influx-token
INFLUX_ORG=heartguard
INFLUX_BUCKET=heartguard_signals
GCS_BUCKET=heartguard-system
SERVICE_ACCOUNT_EMAIL=751259101579-compute@developer.gserviceaccount.com
GOOGLE_APPLICATION_CREDENTIALS=/run/secrets/gcp-sa.json
OTEL_EXPORTER_OTLP_ENDPOINT=

# ---- Gateway Service (port 5000) ----
GATEWAY_PORT=5000
GATEWAY_JWT_SECRET=change-me-gateway
GATEWAY_JWT_EXPIRES_IN=900
GATEWAY_REFRESH_TOKEN_TTL=604800
GATEWAY_ALLOWED_ORIGINS=https://app.heartguard.com,https://admin.heartguard.com
GATEWAY_RATE_LIMIT=200/minute
GATEWAY_LOG_LEVEL=INFO

# ---- Auth Service (port 5001) ----
AUTH_PORT=5001
AUTH_DB_SCHEMA=auth
POSTGRES_URL_AUTH=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${AUTH_DB_SCHEMA}
AUTH_JWT_SECRET=change-me-auth
AUTH_JWT_EXPIRES_IN=900
AUTH_REFRESH_TOKEN_TTL=604800
AUTH_ALLOWED_ORIGINS=https://app.heartguard.com
AUTH_RATE_LIMIT=100/minute
AUTH_LOG_LEVEL=INFO
AUTH_ACCESS_TOKEN_AUD=heartguard-clients
AUTH_REFRESH_TOKEN_AUD=heartguard-refresh

# ---- Organization Service (port 5002) ----
ORGANIZATION_PORT=5002
ORGANIZATION_DB_SCHEMA=organization
POSTGRES_URL_ORGANIZATION=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${ORGANIZATION_DB_SCHEMA}
ORGANIZATION_JWT_SECRET=${AUTH_JWT_SECRET}
ORGANIZATION_ALLOWED_ORIGINS=https://admin.heartguard.com
ORGANIZATION_RATE_LIMIT=80/minute
ORGANIZATION_LOG_LEVEL=INFO

# ---- User Service (port 5003) ----
USER_PORT=5003
USER_DB_SCHEMA=user_ctx
POSTGRES_URL_USER=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${USER_DB_SCHEMA}
USER_JWT_SECRET=${AUTH_JWT_SECRET}
USER_ALLOWED_ORIGINS=https://app.heartguard.com
USER_RATE_LIMIT=150/minute
USER_LOG_LEVEL=INFO

# ---- Patient Service (port 5004) ----
PATIENT_PORT=5004
PATIENT_DB_SCHEMA=patient
POSTGRES_URL_PATIENT=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${PATIENT_DB_SCHEMA}
PATIENT_JWT_SECRET=${AUTH_JWT_SECRET}
PATIENT_ALLOWED_ORIGINS=https://admin.heartguard.com
PATIENT_RATE_LIMIT=120/minute
PATIENT_LOG_LEVEL=INFO

# ---- Device Service (port 5005) ----
DEVICE_PORT=5005
DEVICE_DB_SCHEMA=device
POSTGRES_URL_DEVICE=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${DEVICE_DB_SCHEMA}
DEVICE_JWT_SECRET=${AUTH_JWT_SECRET}
DEVICE_ALLOWED_ORIGINS=https://admin.heartguard.com
DEVICE_RATE_LIMIT=120/minute
DEVICE_LOG_LEVEL=INFO

# ---- Influx Service (port 5006) ----
INFLUX_SERVICE_PORT=5006
INFLUX_SERVICE_JWT_SECRET=${AUTH_JWT_SECRET}
INFLUX_SERVICE_ALLOWED_ORIGINS=https://app.heartguard.com
INFLUX_SERVICE_RATE_LIMIT=180/minute
INFLUX_SERVICE_LOG_LEVEL=INFO
INFLUX_SERVICE_PAGE_SIZE_DEFAULT=200
INFLUX_SERVICE_PAGE_SIZE_MAX=1000

# ---- Inference Service (port 5007) ----
INFERENCE_PORT=5007
INFERENCE_DB_SCHEMA=inference
POSTGRES_URL_INFERENCE=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${INFERENCE_DB_SCHEMA}
INFERENCE_JWT_SECRET=${AUTH_JWT_SECRET}
INFERENCE_ALLOWED_ORIGINS=https://admin.heartguard.com
INFERENCE_RATE_LIMIT=120/minute
INFERENCE_LOG_LEVEL=INFO
INFERENCE_MODEL_STORAGE_PATH=/models

# ---- Alert Service (port 5008) ----
ALERT_PORT=5008
ALERT_DB_SCHEMA=alert
POSTGRES_URL_ALERT=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${ALERT_DB_SCHEMA}
ALERT_JWT_SECRET=${AUTH_JWT_SECRET}
ALERT_ALLOWED_ORIGINS=https://admin.heartguard.com
ALERT_RATE_LIMIT=120/minute
ALERT_LOG_LEVEL=INFO

# ---- Notification Service (port 5009) ----
NOTIFICATION_PORT=5009
NOTIFICATION_DB_SCHEMA=notification
POSTGRES_URL_NOTIFICATION=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${NOTIFICATION_DB_SCHEMA}
NOTIFICATION_JWT_SECRET=${AUTH_JWT_SECRET}
NOTIFICATION_ALLOWED_ORIGINS=https://admin.heartguard.com
NOTIFICATION_RATE_LIMIT=120/minute
NOTIFICATION_LOG_LEVEL=INFO
NOTIFICATION_PUSH_TTL_SECONDS=3600

# ---- Media Service (port 5010) ----
MEDIA_PORT=5010
MEDIA_DB_SCHEMA=media
POSTGRES_URL_MEDIA=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${MEDIA_DB_SCHEMA}
MEDIA_JWT_SECRET=${AUTH_JWT_SECRET}
MEDIA_ALLOWED_ORIGINS=https://app.heartguard.com
MEDIA_RATE_LIMIT=60/minute
MEDIA_LOG_LEVEL=INFO
MEDIA_MAX_FILE_SIZE_MB=50
MEDIA_ALLOWED_MIME=image/png,image/jpeg,application/pdf
MEDIA_SIGNED_URL_TTL=3600

# ---- Audit Service (port 5011) ----
AUDIT_PORT=5011
AUDIT_DB_SCHEMA=audit
POSTGRES_URL_AUDIT=postgresql://heartguard:change_me@${POSTGRES_HOST}:${POSTGRES_PORT}/heartguard?options=-csearch_path%3D${AUDIT_DB_SCHEMA}
AUDIT_JWT_SECRET=${AUTH_JWT_SECRET}
AUDIT_ALLOWED_ORIGINS=https://admin.heartguard.com
AUDIT_RATE_LIMIT=60/minute
AUDIT_LOG_LEVEL=INFO

# ---- RabbitMQ exchanges ----
RABBITMQ_INFERENCE_EXCHANGE=inference.fanout
RABBITMQ_ALERT_EXCHANGE=alert.direct
RABBITMQ_NOTIFICATION_EXCHANGE=notification.topic
RABBITMQ_AUDIT_EXCHANGE=audit.fanout

# ---- Feature flags / opcionales ----
ENABLE_XML_LOGGING=true
ENABLE_PROMETHEUS_METRICS=true

