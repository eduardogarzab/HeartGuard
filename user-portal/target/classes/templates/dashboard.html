<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>HeartGuard - Dashboard</title>
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
<header class="top-nav">
    <div class="logo">HeartGuard</div>
    <nav>
        <a href="/dashboard" class="active">Pacientes</a>
        <a href="/alerts">Alertas</a>
        <a href="/devices">Dispositivos</a>
        <a href="/profile">Mi Perfil</a>
        <form method="post" action="/logout" class="inline-form">
            <button type="submit" class="link-button">Cerrar sesi√≥n</button>
        </form>
    </nav>
    <div class="alert-badge" th:text="${alertsCount}" th:classappend="${alertsCount} > 0 ? ' has-alerts' : ''">0</div>
</header>
<main class="content">
    <section class="panel">
        <h1>Mis Pacientes</h1>
        
        <!-- Mostrar error si existe -->
        <div th:if="${error}" style="background: #fee2e2; border: 1px solid #ef4444; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; color: #991b1b;">
            <strong>‚ö†Ô∏è Error:</strong> <span th:text="${error}">Error message</span>
        </div>
        
        <!-- Mensaje de debug para ver cu√°ntos pacientes hay -->
        <div style="background: #e0f2fe; border: 1px solid #0284c7; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; color: #075985;">
            <strong>üîç Debug:</strong> Pacientes encontrados: <span th:text="${patients.size()}">0</span>
        </div>
        
        <p th:if="${#lists.isEmpty(patients) and error == null}">A√∫n no tienes pacientes asignados.</p>
        <div class="patient-grid" th:if="${!#lists.isEmpty(patients)}">
            <a class="patient-card" th:each="patient : ${patients}" th:href="@{'/patient/' + ${patient.id}}">
                <div class="patient-photo" th:style="${patient.profilePhotoUrl} != null ? 'background-image: url(' + ${patient.profilePhotoUrl} + ')' : ''"></div>
                <div class="patient-info">
                    <h2 th:text="${patient.personName}">Nombre</h2>
                    <span class="risk" th:text="${patient.riskLevelCode}">medium</span>
                </div>
            </a>
        </div>
    </section>
</main>
</body>
</html>
